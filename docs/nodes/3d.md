# 3D Category

> 3D geometry, materials, lighting, and rendering using Three.js in LATCH.

**Category Color:** Blue (`#0EA5E9`)
**Icon:** `box`

---

## Scene 3D

Container for 3D objects - the root of a 3D scene graph.

### Info

Acts as the root container that holds all 3D objects, lights, and groups. Every 3D pipeline starts here. Connect objects to the input and pass the scene output to Render 3D along with a camera.

**Tips:**
- Enable Show Grid during development to help with object placement and scale reference.
- Set the background color to match your intended environment before adding lights.
- Connect multiple objects to the objects input; the node accepts several connections.

**Works well with:** Render 3D, Camera 3D, Ambient Light, Directional Light

| Property | Value |
|----------|-------|
| **ID** | `scene-3d` |
| **Icon** | `box` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `objects` | `object3d` | Objects to add (multiple) |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `scene` | `scene3d` | The Three.js Scene |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `backgroundColor` | `color` | `#000000` | Scene background color |
| `showGrid` | `toggle` | `false` | Show grid helper |

### Implementation
Creates a `THREE.Scene` and adds all connected objects to it. Can include meshes, lights, groups, etc.

---

## Camera 3D

Perspective or orthographic camera for viewing scenes.

### Info

Defines the viewpoint used to render a 3D scene. Supports both perspective projection, which mimics human vision with foreshortening, and orthographic projection, which preserves parallel lines. Connect it to Render 3D alongside a scene to produce an image.

**Tips:**
- Lower the FOV (30-40) for a telephoto look or raise it (90+) for a wide-angle feel.
- Switch to orthographic mode for UI mockups or isometric game views.
- Animate the position inputs with an LFO or time node to create camera sweeps.

**Works well with:** Render 3D, Scene 3D, Transform 3D

| Property | Value |
|----------|-------|
| **ID** | `camera-3d` |
| **Icon** | `camera` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `posX/Y/Z` | `number` | Position override |
| `targetX/Y/Z` | `number` | Look-at target override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `camera` | `camera3d` | The Three.js Camera |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `type` | `select` | `perspective` | options: perspective, orthographic | Camera type |
| `fov` | `number` | `50` | min: 10, max: 120 | Field of view (perspective) |
| `near` | `number` | `0.1` | - | Near clipping plane |
| `far` | `number` | `1000` | - | Far clipping plane |
| `orthoSize` | `number` | `5` | - | Ortho frustum size |
| `posX/Y/Z` | `number` | 0, 2, 5 | - | Camera position |
| `targetX/Y/Z` | `number` | 0, 0, 0 | - | Look-at target |

### Implementation
Creates `THREE.PerspectiveCamera` or `THREE.OrthographicCamera` based on type. Uses `lookAt()` to point at target.

---

## Render 3D

Render a 3D scene to texture output.

### Info

Takes a scene and a camera and produces a rendered texture output. This is the final step in any 3D pipeline. It can also output a depth buffer for post-processing effects.

**Tips:**
- Increase width and height for sharper output, but watch performance on complex scenes.
- Enable Include Depth to get a depth texture for fog, DOF, or edge-detection effects.
- Connect the texture output to an image display or further processing nodes.

**Works well with:** Scene 3D, Camera 3D

| Property | Value |
|----------|-------|
| **ID** | `render-3d` |
| **Icon** | `image` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `scene` | `scene3d` | Scene to render (required) |
| `camera` | `camera3d` | Camera to use (required) |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `texture` | `texture` | Rendered output |
| `depth` | `texture` | Depth buffer texture |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `width` | `number` | `512` | min: 64, max: 2048 | Output width |
| `height` | `number` | `512` | min: 64, max: 2048 | Output height |
| `includeDepth` | `toggle` | `false` | - | Output depth texture |

### Implementation
Uses `THREE.WebGLRenderer` with `WebGLRenderTarget` to render scene to texture. The output can be fed into 2D visual nodes.

---

## Box 3D

Create a box/cube mesh.

### Info

Creates a rectangular box mesh with configurable width, height, and depth. It is the most common primitive for building architectural elements, platforms, and placeholder geometry in a 3D scene.

**Tips:**
- Connect a Material 3D node to the material input to override the default flat color.
- Set one dimension very small to approximate a wall or panel.
- Use Transform 3D after this node to rotate or reposition the box without editing its own controls.

**Works well with:** Material 3D, Transform 3D, Scene 3D, Group 3D

| Property | Value |
|----------|-------|
| **ID** | `box-3d` |
| **Icon** | `box` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `width/height/depth` | `number` | Dimension overrides |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `width` | `number` | `1` | Width |
| `height` | `number` | `1` | Height |
| `depth` | `number` | `1` | Depth |
| `color` | `color` | `#808080` | Default material color |

### Implementation
Creates `THREE.BoxGeometry` with `THREE.MeshStandardMaterial`. If material input is connected, uses that instead of default.

---

## Sphere 3D

Create a sphere mesh.

### Info

Creates a sphere mesh with configurable radius and segment counts. Higher segment values produce smoother surfaces. It is a good primitive for testing materials and lighting setups.

**Tips:**
- Use 32 width segments and 16 height segments as a balanced default for most use cases.
- Lower segment counts intentionally for a faceted, low-poly look.
- Connect a Material 3D with high metalness and low roughness to see clear environment reflections.

**Works well with:** Material 3D, Transform 3D, Scene 3D, Point Light

| Property | Value |
|----------|-------|
| **ID** | `sphere-3d` |
| **Icon** | `circle` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `radius` | `number` | Radius override |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `radius` | `number` | `0.5` | - | Sphere radius |
| `widthSegments` | `number` | `32` | min: 3, max: 64 | Horizontal segments |
| `heightSegments` | `number` | `16` | min: 2, max: 32 | Vertical segments |
| `color` | `color` | `#808080` | - | Default color |

### Implementation
Creates `THREE.SphereGeometry`. Higher segment counts = smoother sphere.

---

## Plane 3D

Create a flat plane mesh.

### Info

Creates a flat rectangular surface. Planes are useful as ground floors, walls, backgrounds, or shadow-receiving surfaces beneath other objects.

**Tips:**
- Place a large plane at Y=0 to act as a ground that catches shadows from directional lights.
- Set the material side to double so the plane is visible from both sides.
- Scale up width and height rather than using Transform 3D scale to keep UV coordinates consistent.

**Works well with:** Material 3D, Scene 3D, Directional Light, Transform 3D

| Property | Value |
|----------|-------|
| **ID** | `plane-3d` |
| **Icon** | `square` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `width/height` | `number` | Dimension overrides |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `width` | `number` | `1` | Plane width |
| `height` | `number` | `1` | Plane height |
| `color` | `color` | `#808080` | Default color |

### Implementation
Creates `THREE.PlaneGeometry`. Default orientation is XY plane (facing +Z).

---

## Cylinder 3D

Create a cylinder mesh.

### Info

Generates a cylinder mesh with independent top and bottom radii. Setting one radius to zero produces a cone, making this node flexible for columns, pipes, and tapered shapes.

**Tips:**
- Set Radius Top to 0 to create a cone.
- Increase the segment count for smoother silhouettes when the cylinder is large on screen.
- Combine with Transform 3D to lay the cylinder on its side for log or pipe shapes.

**Works well with:** Material 3D, Transform 3D, Scene 3D, Group 3D

| Property | Value |
|----------|-------|
| **ID** | `cylinder-3d` |
| **Icon** | `cylinder` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `radiusTop/Bottom` | `number` | Radius overrides |
| `height` | `number` | Height override |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `radiusTop` | `number` | `0.5` | - | Top radius |
| `radiusBottom` | `number` | `0.5` | - | Bottom radius |
| `height` | `number` | `1` | - | Cylinder height |
| `radialSegments` | `number` | `32` | min: 3, max: 64 | Radial segments |
| `color` | `color` | `#808080` | - | Default color |

### Implementation
Creates `THREE.CylinderGeometry`. Set `radiusTop` to 0 for a cone.

---

## Torus 3D

Create a torus (donut) mesh.

### Info

Creates a torus (donut-shaped) mesh defined by an outer radius and a tube radius. Segment controls let you balance visual smoothness against performance.

**Tips:**
- Set tube radius close to the main radius for a thick ring, or very small for a thin hoop.
- Reduce radial segments to 6 or 8 for a stylized hexagonal or octagonal ring.
- Apply a Transform 3D to tilt the torus for use as a ring, halo, or orbit path.

**Works well with:** Material 3D, Transform 3D, Scene 3D, Group 3D

| Property | Value |
|----------|-------|
| **ID** | `torus-3d` |
| **Icon** | `circle-dot` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `radius` | `number` | Main radius override |
| `tube` | `number` | Tube radius override |
| `material` | `material3d` | Material override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The mesh object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `radius` | `number` | `0.5` | - | Main radius |
| `tube` | `number` | `0.2` | - | Tube radius |
| `radialSegments` | `number` | `16` | min: 2, max: 32 | Radial segments |
| `tubularSegments` | `number` | `100` | min: 3, max: 200 | Tubular segments |
| `color` | `color` | `#808080` | - | Default color |

### Implementation
Creates `THREE.TorusGeometry`.

---

## Transform 3D

Apply position, rotation, and scale to a 3D object.

### Info

Applies position, rotation, and scale to any 3D object without modifying the original geometry. Chain multiple transforms or drive inputs with animated values for motion. The transform output can also be reused by other nodes.

**Tips:**
- Connect an LFO or time node to rotation inputs for continuous spinning animations.
- Stack transforms by feeding one transform output into the next for complex motion.
- Use non-uniform scale (different X, Y, Z) to stretch primitives into new shapes.

**Works well with:** Box 3D, Sphere 3D, Group 3D, GLTF Loader, Scene 3D

| Property | Value |
|----------|-------|
| **ID** | `transform-3d` |
| **Icon** | `move-3d` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | Object to transform (required) |
| `posX/Y/Z` | `number` | Position override |
| `rotX/Y/Z` | `number` | Rotation override (degrees) |
| `scaleX/Y/Z` | `number` | Scale override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | Transformed object |
| `transform` | `transform3d` | Transform data |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `posX/Y/Z` | `number` | `0` | Position |
| `rotX/Y/Z` | `number` | `0` | Rotation (degrees) |
| `scaleX/Y/Z` | `number` | `1` | Scale |

### Implementation
Modifies the object's `position`, `rotation`, and `scale` properties. Rotation is converted from degrees to radians.

---

## Material 3D

Create a PBR (Physically Based Rendering) material.

### Info

Creates a PBR (physically based rendering) material that controls how surfaces look under lighting. Supports metalness, roughness, opacity, emissive glow, wireframe mode, and texture map inputs for detailed surfaces.

**Tips:**
- Set metalness to 1 and roughness near 0 for a mirror-like chrome finish.
- Use the physical type for the most accurate PBR response to lighting.
- Connect texture maps to the color, normal, or roughness inputs for realistic detail without extra geometry.

**Works well with:** Box 3D, Sphere 3D, Cylinder 3D, Torus 3D, GLTF Loader

| Property | Value |
|----------|-------|
| **ID** | `material-3d` |
| **Icon** | `palette` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `colorMap` | `texture` | Albedo/diffuse texture |
| `normalMap` | `texture` | Normal map |
| `roughnessMap` | `texture` | Roughness map |
| `metalnessMap` | `texture` | Metalness map |
| `metalness/roughness/opacity` | `number` | Value overrides |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `material` | `material3d` | The material |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `type` | `select` | `standard` | options: standard, basic, phong, physical | Material type |
| `color` | `color` | `#808080` | - | Base color |
| `metalness` | `slider` | `0` | min: 0, max: 1 | Metalness |
| `roughness` | `slider` | `0.5` | min: 0, max: 1 | Roughness |
| `opacity` | `slider` | `1` | min: 0, max: 1 | Opacity |
| `wireframe` | `toggle` | `false` | - | Wireframe mode |
| `side` | `select` | `front` | options: front, back, double | Render side |
| `emissive` | `color` | `#000000` | - | Emissive color |
| `emissiveIntensity` | `number` | `0` | min: 0, max: 10 | Emissive strength |

### Implementation
Creates `THREE.MeshStandardMaterial`, `THREE.MeshBasicMaterial`, `THREE.MeshPhongMaterial`, or `THREE.MeshPhysicalMaterial` based on type selection.

---

## Group 3D

Combine multiple objects into a group.

### Info

Combines multiple 3D objects into a single group that can be positioned as one unit. Moving or transforming the group affects all children together, which simplifies scene organization.

**Tips:**
- Nest groups inside other groups to build a hierarchy for complex assemblies.
- Apply a single Transform 3D to the group instead of transforming each child individually.
- Connect several primitive shapes to the objects input to build compound objects.

**Works well with:** Scene 3D, Transform 3D, Box 3D, Sphere 3D, GLTF Loader

| Property | Value |
|----------|-------|
| **ID** | `group-3d` |
| **Icon** | `layers` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `objects` | `object3d` | Objects to group (multiple) |
| `posX/Y/Z` | `number` | Group position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | The group object |

### Controls
| Control | Type | Default | Description |
|---------|------|---------|-------------|
| `posX/Y/Z` | `number` | `0` | Group position |

### Implementation
Creates `THREE.Group` and adds all connected objects as children. Transform applied to group affects all children.

---

## Ambient Light

Uniform lighting from all directions.

### Info

Adds a base layer of uniform light that illuminates all objects equally regardless of their position or orientation. Use it to prevent completely black shadows and ensure minimum visibility across the entire scene.

**Tips:**
- Keep intensity low (0.1 to 0.3) so directional and point lights can still define shape.
- Pair with a directional light to simulate outdoor lighting with soft fill.
- Tint the color slightly blue or warm orange to set the overall mood before adding other lights.

**Works well with:** Scene 3D, Directional Light, Point Light, Material 3D

| Property | Value |
|----------|-------|
| **ID** | `ambient-light-3d` |
| **Icon** | `sun` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `0.5` | min: 0, max: 2 | Light intensity |

### Implementation
Creates `THREE.AmbientLight`. Illuminates all surfaces equally regardless of orientation.

---

## Directional Light

Sun-like light from a specific direction.

### Info

Emits parallel light rays from a given direction, simulating a distant source like the sun. All objects receive the same angle of light regardless of their position. Supports shadow casting for grounded, realistic scenes.

**Tips:**
- Position the light high and to the side (e.g., 5, 5, 5) for classic three-quarter lighting.
- Enable Cast Shadow and add a plane underneath objects to see ground shadows.
- Combine with a low-intensity Ambient Light to fill in shadow areas.

**Works well with:** Scene 3D, Ambient Light, Material 3D, Plane 3D

| Property | Value |
|----------|-------|
| **ID** | `directional-light-3d` |
| **Icon** | `sun-dim` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `1` | min: 0, max: 5 | Light intensity |
| `posX/Y/Z` | `number` | 5, 5, 5 | - | Light position (direction) |
| `castShadow` | `toggle` | `true` | - | Enable shadows |

### Implementation
Creates `THREE.DirectionalLight`. Light direction is from position toward scene origin.

---

## Point Light

Omnidirectional light radiating from a point.

### Info

Emits light equally in all directions from a single point in space, similar to a bare light bulb. Intensity falls off with distance based on the decay setting. Works well for indoor scenes and localized highlights.

**Tips:**
- Set distance to 0 for infinite range, or use a positive value to limit the light radius.
- Increase decay for a more realistic, physically based falloff.
- Place several point lights at low intensity around a room for soft, even indoor illumination.

**Works well with:** Scene 3D, Ambient Light, Material 3D, Spot Light

| Property | Value |
|----------|-------|
| **ID** | `point-light-3d` |
| **Icon** | `lightbulb` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `1` | min: 0, max: 5 | Light intensity |
| `distance` | `number` | `0` | min: 0 | Falloff distance (0 = infinite) |
| `decay` | `number` | `2` | min: 0, max: 5 | Light decay rate |
| `posX/Y/Z` | `number` | 0, 2, 0 | - | Light position |
| `castShadow` | `toggle` | `false` | - | Enable shadows |

### Implementation
Creates `THREE.PointLight`. Emits light equally in all directions from position.

---

## Spot Light

Cone-shaped spotlight.

### Info

Projects a cone of light from a point toward a target, like a stage spotlight or flashlight. The angle and penumbra controls shape the cone edge. Supports shadow casting for dramatic, focused lighting.

**Tips:**
- Increase penumbra toward 1 for a soft-edged falloff at the cone boundary.
- Narrow the angle to create a tight, focused beam for dramatic highlights.
- Aim the target position at the object you want to emphasize in the scene.

**Works well with:** Scene 3D, Ambient Light, Material 3D, Point Light

| Property | Value |
|----------|-------|
| **ID** | `spot-light-3d` |
| **Icon** | `flashlight` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `intensity` | `number` | Intensity override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `light` | `light3d` | The light object |
| `object` | `object3d` | As generic object |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `color` | `color` | `#ffffff` | - | Light color |
| `intensity` | `slider` | `1` | min: 0, max: 5 | Light intensity |
| `distance` | `number` | `0` | min: 0 | Falloff distance |
| `angle` | `slider` | `30` | min: 1, max: 90 | Cone angle (degrees) |
| `penumbra` | `slider` | `0.1` | min: 0, max: 1 | Soft edge percentage |
| `decay` | `number` | `2` | min: 0, max: 5 | Light decay |
| `posX/Y/Z` | `number` | 0, 5, 0 | - | Light position |
| `targetX/Y/Z` | `number` | 0, 0, 0 | - | Target position |
| `castShadow` | `toggle` | `true` | - | Enable shadows |

### Implementation
Creates `THREE.SpotLight`. Points from position toward target.

---

## GLTF Loader

Load 3D models in GLTF/GLB format.

### Info

Loads external 3D models in GLTF or GLB format from a URL and outputs them as scene objects. This is the primary way to bring complex, pre-built assets into the scene. The loading output lets you show progress feedback.

**Tips:**
- Use the scale control to normalize models that were exported at different unit scales.
- Check the error output to catch missing or malformed URLs early.
- Host GLB files on a CORS-enabled server or use local file paths in Electron.

**Works well with:** Scene 3D, Transform 3D, Material 3D, Group 3D

| Property | Value |
|----------|-------|
| **ID** | `gltf-loader` |
| **Icon** | `file-box` |
| **Version** | 1.0.0 |

### Inputs
| Port | Type | Description |
|------|------|-------------|
| `url` | `string` | Model URL override |
| `posX/Y/Z` | `number` | Position override |

### Outputs
| Port | Type | Description |
|------|------|-------------|
| `object` | `object3d` | Loaded model |
| `loading` | `boolean` | Loading state |
| `error` | `string` | Error message |

### Controls
| Control | Type | Default | Props | Description |
|---------|------|---------|-------|-------------|
| `url` | `text` | `''` | - | Model URL |
| `posX/Y/Z` | `number` | `0` | - | Initial position |
| `scale` | `number` | `1` | min: 0.001, max: 100 | Model scale |

### Implementation
Uses Three.js `GLTFLoader` to load GLTF/GLB files. Supports embedded textures, animations, and materials.
